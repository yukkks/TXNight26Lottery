<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hold to Lock</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;700&display=swap">
  <style>
    :root{
      --bg:#040815;
      --card:#091024;
      --text:#ffffff;
      --muted:rgba(255,255,255,.72);
      --muted2:rgba(255,255,255,.42);
      --bar:rgba(0,210,211,.95);
      --bar2:rgba(0,210,211,.25);
      --success:#00D2D3;
      --space-1: 4px;
      --space-2: 8px;
      --space-3: 12px;
      --space-4: 16px;
      --space-5: 20px;
      --space-6: 24px;
      --ease: cubic-bezier(.2,.8,.2,1);
    }
    html, body { height: 100%; margin: 0; background: var(--bg); }
    body {
      min-height: 100vh;
      color: var(--text);
      font-family: "Space Grotesk", system-ui, -apple-system, "Segoe UI", sans-serif;
      background:
        radial-gradient(1200px 500px at 50% -10%, rgba(255,255,255,.06), rgba(0,0,0,0)),
        linear-gradient(180deg, #0a1124 0%, #040815 60%, #030611 100%);
    }
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='0.06'/%3E%3C/svg%3E");
      mix-blend-mode: soft-light;
      opacity: 0.35;
      z-index: 1;
    }
    body::after{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        repeating-linear-gradient(0deg, rgba(0,210,211,.06) 0 1px, rgba(0,0,0,0) 1px 40px),
        repeating-linear-gradient(90deg, rgba(0,210,211,.05) 0 1px, rgba(0,0,0,0) 1px 40px),
        radial-gradient(120% 120% at 50% 40%, rgba(0,0,0,0) 0%, rgba(0,0,0,.35) 55%, rgba(0,0,0,.65) 100%);
      z-index: 1;
    }
    body::after{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: radial-gradient(120% 120% at 50% 40%, rgba(0,0,0,0) 0%, rgba(0,0,0,.35) 55%, rgba(0,0,0,.65) 100%);
      z-index: 1;
    }
    body > * { position: relative; z-index: 2; }

    .box {
      background: var(--card);
      border-radius: 18px;
      box-shadow: 0 8px 30px rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.06);
      outline: 1px solid rgba(0,210,211,.12);
      outline-offset: -1px;
      position: relative;
    }
    .box::before,
    .box::after{
      content:"";
      position: absolute;
      width: 18px;
      height: 18px;
      border: 1px solid rgba(0,210,211,.35);
      opacity: 0.8;
    }
    .box::before{
      top: 10px; left: 10px;
      border-right: none; border-bottom: none;
    }
    .box::after{
      bottom: 10px; right: 10px;
      border-left: none; border-top: none;
    }
    .box::before{
      box-shadow: 0 0 18px rgba(0,210,211,.15);
    }
    .box::after{
      box-shadow: 0 0 18px rgba(0,210,211,.15);
    }
    .box .sweep{
      position:absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }
    .box .sweep::after{
      content:"";
      position:absolute;
      inset: -10%;
      background:
        repeating-linear-gradient(90deg, rgba(0,210,211,.08) 0 2px, rgba(0,0,0,0) 2px 10px),
        repeating-linear-gradient(0deg, rgba(0,210,211,.06) 0 1px, rgba(0,0,0,0) 1px 12px);
      opacity: 0.18;
      animation: glitchGlow 3.6s steps(2, end) infinite;
      mix-blend-mode: screen;
    }
    @keyframes glitchGlow{
      0% { transform: translate(0,0); opacity: 0.12; }
      45% { transform: translate(-2px, 1px); opacity: 0.2; }
      60% { transform: translate(3px, -1px); opacity: 0.28; }
      100% { transform: translate(0,0); opacity: 0.12; }
    }

    .bolts{
      position:absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0;
    }
    .success .bolts{
      opacity: 1;
    }
    .bolt{
      position:absolute;
      width: 3px;
      height: 36px;
      background: linear-gradient(180deg, rgba(0,210,211,0), rgba(0,210,211,.95), rgba(0,210,211,0));
      filter: drop-shadow(0 0 10px rgba(0,210,211,.8));
      border-radius: 2px;
      animation: bolt 700ms steps(2, end) infinite;
    }
    .bolt.b1{ left: -6px; top: 30px; transform: rotate(18deg); animation-delay: 0ms; }
    .bolt.b2{ right: -6px; top: 60px; transform: rotate(-20deg); animation-delay: 140ms; }
    .bolt.b3{ left: -4px; top: 110px; transform: rotate(14deg); animation-delay: 260ms; }
    .bolt.b4{ right: -4px; top: 150px; transform: rotate(-16deg); animation-delay: 380ms; }

    @keyframes bolt{
      0% { opacity: 0; transform: translateY(0) scaleY(0.6); }
      20% { opacity: 1; }
      60% { opacity: 0.9; transform: translateY(4px) scaleY(1); }
      100% { opacity: 0; transform: translateY(10px) scaleY(0.7); }
    }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    .center { display:flex; flex-direction:column; align-items:center; gap: var(--space-3); padding: var(--space-4) var(--space-3); }
    .logo{
      width: 200px;
      max-width: 80vw;
      height: auto;
      margin-bottom: var(--space-1);
      display: block;
      filter: drop-shadow(0 0 14px rgba(0,210,211,.25));
    }

    /* ===== Vertical Bar ===== */
    .barWrap{
      width: 240px; height: auto;
      position: relative;
      border-radius: 18px;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      gap: var(--space-2);
      padding: var(--space-3) 0;
      user-select:none; -webkit-user-select:none;
    }

    /* track */
    .barTrack{
      position:relative;
      width: 72px;
      height: 230px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.08);
      overflow:hidden;
      filter: drop-shadow(0 0 18px rgba(255,255,255,.06));
      box-shadow: inset 0 0 18px rgba(0,0,0,.55), 0 0 12px rgba(0,210,211,.18), 0 0 0 1px rgba(0,210,211,.25);
      transition: filter .2s var(--ease);
    }

    /* fill (bottom -> top) */
    .barFill{
      position:absolute;
      left:0; right:0; bottom:0;
      height: var(--h, 0%);
      background: linear-gradient(to top, var(--bar), var(--bar2));
      border-radius: 999px;
      transition: height 0.12s var(--ease);
    }
    .ticks{
      position:absolute;
      inset: 8px;
      border-radius: 999px;
      pointer-events: none;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .tick{
      height: 2px;
      width: 70%;
      align-self: center;
      background: rgba(255,255,255,.18);
      border-radius: 999px;
      opacity: 0.25;
      transition: opacity .2s var(--ease), background .2s var(--ease);
    }
    .tick.on{
      opacity: 1;
      background: rgba(0,210,211,.9);
      box-shadow: 0 0 10px rgba(0,210,211,.6);
    }

    .copy{
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      gap: var(--space-1);
      margin-top: var(--space-4);
      position:relative;
      z-index: 2;
      text-align: center;
    }
    .cta{
      font-weight: 900;
      letter-spacing: .6px;
      text-transform: uppercase;
      font-size: 1.3rem;
      opacity: .95;
      color: #ffffff;
    }
    .cta.locked{
      color: var(--success);
    }
    .hint{
      font-size: 12px;
      color: var(--muted2);
    }
    .hint.locked{
      font-size: 1.15rem;
      font-weight: 700;
    }
    .status{
      margin-top: var(--space-2);
      color: var(--muted);
      font-size: 13px;
      min-height: 20px;
      text-align:center;
    }
    .hud{
      margin-top: 0;
      font-size: 11px;
      color: rgba(0,210,211,.75);
      letter-spacing: .6px;
      text-transform: uppercase;
    }
    .lockedBadge{
      display:none;
      margin-top: var(--space-2);
      padding: var(--space-1) var(--space-3);
      border-radius: 999px;
      background: rgba(0,210,211,.12);
      color: var(--success);
      border: 1px solid rgba(0,210,211,.35);
      font-weight: 700;
      font-size: 0.9rem;
      letter-spacing: .4px;
      text-transform: uppercase;
    }
    .entryNumber{
      display:none;
      margin-top: var(--space-2);
      font-weight: 700;
      font-size: 1rem;
      letter-spacing: .4px;
      color: var(--success);
      text-transform: uppercase;
    }
    .entryNumber.reveal{
      animation: reveal 520ms steps(2, end);
      text-shadow: 0 0 14px rgba(0,210,211,.6);
    }
    .legal{
      margin-top: var(--space-2);
      font-size: 11px;
      color: var(--muted2);
      letter-spacing: .3px;
      text-transform: uppercase;
    }
    @keyframes reveal{
      0% { opacity: 0; transform: translateY(6px); letter-spacing: 1px; }
      40% { opacity: 1; transform: translateY(0); letter-spacing: .6px; }
      60% { opacity: 0.6; filter: blur(1px); }
      100% { opacity: 1; filter: blur(0); }
    }
    .success .lockedBadge{
      display: inline-block;
    }
    .success .entryNumber{
      display: inline-block;
    }
    .idleGlow{
      animation: idle 2.2s ease-in-out infinite;
    }
    @keyframes idle{
      0% { opacity: 0.65; letter-spacing: .6px; }
      50% { opacity: 1; letter-spacing: .8px; }
      100% { opacity: 0.65; letter-spacing: .6px; }
    }

    /* Hold-down visual state */
    .pressed .barTrack{
      filter: drop-shadow(0 0 26px rgba(255,255,255,.14));
      transform: scale(1.02);
      transition: transform .2s var(--ease), filter .2s var(--ease);
    }
    .pressed .barWrap{
      transform: translateY(-1px);
      transition: transform .2s var(--ease);
    }

    /* Success state */
    .success .barFill{
      background: linear-gradient(to top, rgba(0,210,211,.95), rgba(0,210,211,.22));
    }
    .success .barTrack{
      animation: glitch 420ms steps(1, end) 3;
      box-shadow:
        inset 0 0 18px rgba(0,0,0,.55),
        0 0 12px rgba(0,210,211,.45),
        0 0 24px rgba(0,210,211,.25);
    }
    .success .barTrack,
    .success .cta{
      text-shadow:
        1px 0 0 rgba(0,210,211,.6),
        -1px 0 0 rgba(255,0,92,.35);
    }
    @keyframes glitch{
      0% { transform: translate(0,0); filter: hue-rotate(0deg); }
      12% { transform: translate(-5px, -2px); filter: hue-rotate(30deg); }
      24% { transform: translate(5px, 2px); filter: hue-rotate(-24deg); }
      40% { transform: translate(-4px, 3px); filter: hue-rotate(18deg); }
      58% { transform: translate(4px, -3px); filter: hue-rotate(-16deg); }
      76% { transform: translate(-3px, 2px); filter: hue-rotate(12deg); }
      100% { transform: translate(0,0); filter: hue-rotate(0deg); }
    }
    .sparkShower{
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: 0;
      z-index: 20;
    }
    body.shower .sparkShower{
      opacity: 1;
    }
    .spark{
      position: absolute;
      width: 3px;
      height: 14px;
      background: rgba(0,210,211,.95);
      box-shadow: 0 0 12px rgba(0,210,211,.75);
      border-radius: 2px;
      animation: shower 900ms var(--ease) infinite;
    }
    .spark.s1{ left: 6%; top: -6%; animation-delay: 0ms; }
    .spark.s2{ left: 14%; top: -9%; animation-delay: 60ms; }
    .spark.s3{ left: 22%; top: -7%; animation-delay: 120ms; }
    .spark.s4{ left: 30%; top: -10%; animation-delay: 180ms; }
    .spark.s5{ left: 38%; top: -8%; animation-delay: 240ms; }
    .spark.s6{ left: 46%; top: -6%; animation-delay: 300ms; }
    .spark.s7{ left: 54%; top: -9%; animation-delay: 360ms; }
    .spark.s8{ left: 62%; top: -7%; animation-delay: 420ms; }
    .spark.s9{ left: 70%; top: -10%; animation-delay: 480ms; }
    .spark.s10{ left: 78%; top: -8%; animation-delay: 540ms; }
    .spark.s11{ left: 86%; top: -6%; animation-delay: 600ms; }
    .spark.s12{ left: 94%; top: -9%; animation-delay: 660ms; }
    .spark.s13{ left: 10%; top: -12%; animation-delay: 720ms; }
    .spark.s14{ left: 27%; top: -11%; animation-delay: 780ms; }
    .spark.s15{ left: 44%; top: -12%; animation-delay: 840ms; }
    .spark.s16{ left: 60%; top: -11%; animation-delay: 900ms; }
    .spark.s17{ left: 74%; top: -12%; animation-delay: 960ms; }
    .spark.s18{ left: 88%; top: -11%; animation-delay: 1020ms; }

    @keyframes shower{
      0% { transform: translateY(-10vh) rotate(8deg); opacity: 0; }
      15% { opacity: 1; }
      100% { transform: translateY(110vh) rotate(18deg); opacity: 0; }
    }

    .confetti{
      position:absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0;
    }
    .success .confetti{
      opacity: 1;
    }
    .confetti i{
      position:absolute;
      width: 6px;
      height: 10px;
      background: rgba(0,210,211,.95);
      box-shadow: 0 0 10px rgba(0,210,211,.6);
      border-radius: 2px;
      animation: burst 800ms var(--ease) infinite;
    }
    .confetti i:nth-child(1){ left: 50%; bottom: 10px; transform: rotate(12deg); animation-delay: 0ms; }
    .confetti i:nth-child(2){ left: 40%; bottom: 0; transform: rotate(-8deg); animation-delay: 80ms; }
    .confetti i:nth-child(3){ left: 60%; bottom: 4px; transform: rotate(18deg); animation-delay: 140ms; }
    .confetti i:nth-child(4){ left: 30%; bottom: 6px; transform: rotate(-16deg); animation-delay: 200ms; }
    .confetti i:nth-child(5){ left: 70%; bottom: 2px; transform: rotate(22deg); animation-delay: 260ms; }
    .confetti i:nth-child(6){ left: 20%; bottom: 8px; transform: rotate(-20deg); animation-delay: 320ms; }
    .confetti i:nth-child(7){ left: 80%; bottom: 6px; transform: rotate(16deg); animation-delay: 380ms; }

    @keyframes burst{
      0% { transform: translateY(0) scale(1); opacity: 0; }
      15% { opacity: 1; }
      70% { transform: translateY(-26px) scale(0.9); opacity: 0.9; }
      100% { transform: translateY(-40px) scale(0.6); opacity: 0; }
    }

    /* Button tweaks */
    #holdBtn{
      min-width: 180px;
      min-height: 52px;
      touch-action: none;
      user-select: none;
      -webkit-user-select: none;
      font-weight: 700;
      font-size: 1.15rem;
      filter: brightness(0.92);
    }
    .buttons{
      margin-top: 2px;
      margin-bottom: 0;
    }

    /* Success flash */
    .flash{
      position: fixed;
      inset: 0;
      background: rgba(0,210,211,.12);
      opacity: 0;
      pointer-events: none;
      z-index: 30;
      transition: opacity .2s var(--ease);
    }

    /* Scanline for tech vibe */
    .barTrack::after{
      content:"";
      position:absolute;
      inset: 0;
      background:
        linear-gradient(180deg, rgba(0,210,211,.12), rgba(0,210,211,0) 40%, rgba(0,210,211,.12) 70%, rgba(0,210,211,0)),
        repeating-linear-gradient(180deg, rgba(0,210,211,.08) 0 1px, rgba(0,0,0,0) 1px 6px);
      opacity: 0.6;
      animation: scan 2.6s linear infinite;
      pointer-events: none;
    }
    @keyframes scan{
      0% { background-position: 0 0, 0 0; }
      100% { background-position: 0 220px, 0 180px; }
    }
    body.flashOn .flash{
      opacity: 1;
    }

  </style>
</head>

<body>
  <section class="section">
    <div class="container" style="max-width: 620px;">
      <div class="box">
        <div class="sweep" aria-hidden="true"></div>
        <div class="center">
          <img class="logo" src="TX20%Logo.png" alt="IQOS Together X">

          <div id="wrap" class="barWrap" aria-label="Hold to lock entry">
          <div id="track" class="barTrack">
            <div id="fill" class="barFill"></div>
            <div class="ticks" aria-hidden="true">
              <span class="tick"></span>
              <span class="tick"></span>
              <span class="tick"></span>
              <span class="tick"></span>
              <span class="tick"></span>
              <span class="tick"></span>
              <span class="tick"></span>
              <span class="tick"></span>
            </div>
            <div class="confetti" aria-hidden="true">
              <i></i><i></i><i></i><i></i><i></i><i></i><i></i>
            </div>
            <div class="bolts" aria-hidden="true">
              <span class="bolt b1"></span>
              <span class="bolt b2"></span>
              <span class="bolt b3"></span>
              <span class="bolt b4"></span>
            </div>
          </div>


            <div class="copy">
              <div id="cta" class="cta idleGlow">Hold to lock entry</div>
              <div id="sub" class="hint"></div>
            </div>
          </div>

          <div id="status" class="status"></div>
          <div class="hud">SYS: READY • SIGNAL: STANDBY</div>
          <div id="lockedBadge" class="lockedBadge">Locked</div>
          <div id="entryNumber" class="entryNumber"></div>

          <div class="buttons">
            <button id="holdBtn" class="button is-primary">Hold</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="sparkShower" aria-hidden="true">
    <span class="spark s1"></span>
    <span class="spark s2"></span>
    <span class="spark s3"></span>
    <span class="spark s4"></span>
    <span class="spark s5"></span>
    <span class="spark s6"></span>
    <span class="spark s7"></span>
    <span class="spark s8"></span>
    <span class="spark s9"></span>
    <span class="spark s10"></span>
    <span class="spark s11"></span>
    <span class="spark s12"></span>
    <span class="spark s13"></span>
    <span class="spark s14"></span>
    <span class="spark s15"></span>
    <span class="spark s16"></span>
    <span class="spark s17"></span>
    <span class="spark s18"></span>
  </div>
  <div class="flash" aria-hidden="true"></div>

<script>
  // ===== SETTINGS =====
  const HOLD_MS = 1800;
  const LOADING_MS = 0;

  // ===== ELEMENTS =====
  const wrap = document.getElementById("wrap");
  const fill = document.getElementById("fill");
  const status = document.getElementById("status");
  const cta = document.getElementById("cta");
  const sub = document.getElementById("sub");
  const holdBtn = document.getElementById("holdBtn");
  const lockedBadge = document.getElementById("lockedBadge");
  const entryNumber = document.getElementById("entryNumber");
  const ticks = Array.from(document.querySelectorAll(".tick"));

  // ===== STATE =====
  let holding = false;
  let startAt = 0;
  let raf = null;
  let locked = false;
  let loading = false;
  let flashTimer = null;
  let audioCtx = null;

  function setFill(pct){
    const clamped = Math.max(0, Math.min(1, pct));
    // ease-out for a softer feel
    const eased = 1 - Math.pow(1 - clamped, 2);
    fill.style.setProperty("--h", `${eased * 100}%`);
    const onCount = Math.floor(eased * ticks.length);
    ticks.forEach((t, i) => t.classList.toggle("on", i < onCount));
  }
  function show(text){ status.textContent = text; }

  function playSparkSound(){
    try {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = "triangle";
      osc.frequency.setValueAtTime(880, audioCtx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(1320, audioCtx.currentTime + 0.08);
      gain.gain.setValueAtTime(0.001, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.08, audioCtx.currentTime + 0.02);
      gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.12);
      osc.connect(gain).connect(audioCtx.destination);
      osc.start();
      osc.stop(audioCtx.currentTime + 0.14);
    } catch (e) {
      // ignore audio errors
    }
  }


  function resetAll(){
    holding = false;
    startAt = 0;
    locked = false;
    loading = false;
    if (flashTimer) clearTimeout(flashTimer);
    flashTimer = null;
    document.body.classList.remove("flashOn");
    document.body.classList.remove("shower");
    wrap.classList.remove("pressed","success");
    cta.textContent = "Hold to lock entry";
    cta.classList.remove("locked");
    cta.classList.add("idleGlow");
    sub.textContent = "";
    sub.classList.remove("locked");
    show("");
    setFill(0);
    lockedBadge.style.display = "";
    entryNumber.textContent = "";
    holdBtn.style.display = "";
    document.querySelector(".hud").textContent = "SYS: READY • SIGNAL: STANDBY";
    holdBtn.disabled = false;
    holdBtn.textContent = "Hold";
    if (raf) cancelAnimationFrame(raf);
    raf = null;
  }

  async function onComplete(){
    loading = true;
    wrap.classList.remove("pressed");
    holdBtn.disabled = true;
    if (LOADING_MS > 0) await new Promise(r => setTimeout(r, LOADING_MS));

    loading = false;
    locked = true;
    wrap.classList.add("success");
    document.body.classList.add("shower");
    document.body.classList.add("flashOn");
    if (flashTimer) clearTimeout(flashTimer);
    flashTimer = setTimeout(() => {
      document.body.classList.remove("flashOn");
      flashTimer = null;
    }, 220);
    cta.textContent = "Entry locked";
    cta.classList.add("locked");
    cta.classList.remove("idleGlow");
    sub.textContent = "WATCH FOR THE SIGNAL";
    sub.classList.add("locked");
    show("");
    setFill(1);
    const num = String(Math.floor(Math.random() * 9000) + 1000);
    entryNumber.textContent = `Entry #${num}`;
    entryNumber.classList.remove("reveal");
    // trigger reflow to restart animation
    void entryNumber.offsetWidth;
    entryNumber.classList.add("reveal");
    holdBtn.style.display = "none";
    document.querySelector(".hud").textContent = "SYS: LOCKED • SIGNAL: LIVE";

    if (navigator.vibrate) navigator.vibrate([40, 20, 40]);
    playSparkSound();
  }

  function tick(){
    if (!holding) return;
    const elapsed = Date.now() - startAt;
    const pct = Math.min(1, elapsed / HOLD_MS);
    setFill(pct);

    if (elapsed >= HOLD_MS){
      holding = false;
      onComplete();
      return;
    }
    raf = requestAnimationFrame(tick);
  }

  function startHold(e){
    if (locked || loading) return;
    e.preventDefault();
    if (holding) return;

    holding = true;
    startAt = Date.now();
    wrap.classList.add("pressed");

    show("");
    cta.textContent = "Holding…";
    cta.classList.remove("locked");
    cta.classList.remove("idleGlow");
    sub.textContent = "";
    sub.classList.remove("locked");
    document.querySelector(".hud").textContent = "SYS: ARMING • SIGNAL: CHARGING";

    tick();
  }

  function cancelHold(e){
    if (!holding) return;
    e.preventDefault();

    holding = false;
    wrap.classList.remove("pressed");

    cta.textContent = "Hold to lock entry";
    cta.classList.remove("locked");
    cta.classList.add("idleGlow");
    sub.textContent = "";
    sub.classList.remove("locked");
    setFill(0);
    document.querySelector(".hud").textContent = "SYS: READY • SIGNAL: STANDBY";
    if (raf) cancelAnimationFrame(raf);
    raf = null;

    if (navigator.vibrate) navigator.vibrate(15);
  }

  // Hold on the button to fill
  holdBtn.addEventListener("pointerdown", startHold);
  holdBtn.addEventListener("pointerup", cancelHold);
  holdBtn.addEventListener("pointercancel", cancelHold);
  holdBtn.addEventListener("pointerleave", cancelHold);
  holdBtn.addEventListener("click", (e) => e.preventDefault());

  // Optional: double-tap anywhere to reset
  let lastTap = 0;
  window.addEventListener("touchend", () => {
    const now = Date.now();
    if (now - lastTap < 300) resetAll();
    lastTap = now;
  }, {passive:true});

  resetAll();
</script>
</body>
</html>
